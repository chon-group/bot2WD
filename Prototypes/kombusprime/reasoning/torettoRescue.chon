{"id":17,"name":"torettoRescue","agents":[{"archClass":"Argo","name":"toretto","sourceCode":"/* Initial beliefs and rules */\nserialPort(ttyACM0).\n\n/* Initial goals */\n!start.\n\n/* Plans */\n+!start: serialPort(SP) <- \n\t.print(\"Nao importa se foram 10 cm, ou 10 km. Vencer eh vencer!\");\n\t.port(SP);\n\t.limit(1000);\n\t.percepts(open);\n.\n\n+ledStatus(Status): Status == off <- .act(lightOn); .act(breakLOn); /*.act(buzzerOn);*/ .act(ledOn).\n+ledStatus(Status): Status == on <-  .act(lightOff); .act(breakLOff); .act(buzzerOff); .act(ledOff).\n\n+luminosity(N): N < 70 & not ambush <- .print(\"Letty chame ajuda!!!\"); +ambush; .send(letty,tell,ambush).\n\n+abroad(no)[source(X)] <-\n\t.print(\"Thanks \",X);\n\t.send(X,unachieve,greeting)."},{"archClass":"Communicator","name":"letty","sourceCode":"abroad(yes). \nskyNet(\"skynet.chon.group\",5500). \nscott(\"07ba9e4a-d539-4a0e-8c14-4ac336476858\").\nmyUUID(\"41ff1712-b2f0-416d-8232-fef834651e77\").\n\n/* Initial goals */\n+ambush[source(toretto)] <- !conf.\n\n/* Plans */\n+!conf : abroad(yes) & myUUID(ID) & (skyNet(Server,Port)) <- \n\t\t.connectCN(Server,Port,ID); \n\t\t!start.\n\t\t\n+!conf : abroad(no) <- \n\t.print(\"I'am Letty\").\n\t\n+!start : (abroad(yes) & energizing[source(X)]) <- \n\t.print(\"Transporter ready!\"); \n\t-energizing[source(X)]; \n\t+ready; \n\t!start.\n\t\n+!start : (abroad(yes) & (ready & scott(UUID))) <- \n\t-ready; \n\t-abroad(yes); \n\t.moveOut(UUID,inquilinism).\n\t\n+!start : (abroad(yes) & scott(UUID)) <- \n\t.print(\"Letty to Scotty...\"); \n\t.sendOut(UUID,tell,beam_us_up_scotty); \n\t.wait(2500); \n\t!start.\n\t\n+!start: abroad(no) <- \n\t.print(\"I'am Letty'\").\n\t\n+abroad(no)[source(X)] <-\n\t.print(\"Thanks Tej\");\n\t.send(X,unachieve,greeting)."}],"firmwares":[{"name":"kom","sourceCode":"#include <Javino.h>     //Available at: https://github.com/chon-group/javino2arduino\n#include <HCSR04.h>     //Available at: https://github.com/Martinsos/arduino-lib-hc-sr04\n\n#define PinLight  2     // Farol\n#define PinBreakL 3     // Freio\n#define PinEcho   4     // Sensor de Ultrasom Echo 4 e Trig 5\n#define PinTrig   5              \n#define PinBuzzer 6     // Buzzer\n#define PinBridH1 7     // Ponte H M1=7, M2=8, M3=9, M4=10\n#define PinBridH2 8\n#define PinBridH3 9\n#define PinBridH4 10\n#define PinLed    13    // Alerta ou Giroflex\n#define PinLDR    A0    // Sensor de Luz\n\n\nJavino javino;\nUltraSonicDistanceSensor hc(PinTrig, PinEcho);\nString strLedStatus, strLightStatus, strBreakLStatus, strBuzzerStatus, strMotorStatus;\nunsigned long lastPercept = -1;\n\nvoid serialEvent(){\n   javino.readSerial();\n}\n\n\nvoid loop(){\nif(javino.availableMsg()){\n  String strMsg = javino.getMsg();\n  if(strMsg==\"getPercepts\"){javino.sendMsg(getStatus());}\n    else if(strMsg==\"buzzerOn\") {buzzer(\"on\");}\n    else if(strMsg==\"buzzerOff\")  {buzzer(\"off\");}\n    else if(strMsg==\"ledOn\")  {led(\"on\");}\n    else if(strMsg==\"ledOff\") {led(\"off\");}\n    else if(strMsg==\"lightOn\")  {light(\"on\");}\n    else if(strMsg==\"lightOff\") {light(\"off\");}\n    else if(strMsg==\"breakLOn\") {breakL(\"on\");}\n    else if(strMsg==\"breakLOff\")  {breakL(\"off\");}\n    else if(strMsg==\"stop\") {stopRightNow();}\n    else if(strMsg==\"goLeft\") {turnLeft();}\n    else if(strMsg==\"goRight\")  {turnRight();}\n    else if(strMsg==\"goAhead\")  {goAhead();}\n\n    lastPercept = millis();\n  }\n\n  if((lastPercept != -1) && (millis() > lastPercept+5000)){\n    powerOff();\n  }\n}\n\nvoid buzzer(String strOpt){\nif(strOpt==\"on\"){digitalWrite(PinBuzzer, HIGH);}\n  else{digitalWrite(PinBuzzer, LOW);}\nsetBuzzerStatus(strOpt);\n}\n\nvoid led(String strledOpt){\nif(strledOpt==\"on\"){digitalWrite(PinLed, HIGH);}\n  else{digitalWrite(PinLed, LOW);}\nsetLedStatus(strledOpt);\n}\n\nvoid light(String strledOpt){\nif(strledOpt==\"on\"){digitalWrite(PinLight, HIGH);}\n  else{digitalWrite(PinLight, LOW);}\nsetLightStatus(strledOpt);\n}\n\nvoid breakL(String strledOpt){\n  if(strledOpt==\"on\"){\n    digitalWrite(PinBreakL, HIGH);\n  }else{\n    digitalWrite(PinBreakL, LOW);\n  }\n  setBreakLStatus(strledOpt);\n}\n\nvoid goAhead(){\n    digitalWrite(PinBridH1, HIGH);\n    digitalWrite(PinBridH2, LOW);\n    digitalWrite(PinBridH3, HIGH);\n    digitalWrite(PinBridH4, LOW);\n    setMotorStatus(\"running\");\n}\n\n\nvoid stopRightNow(){\n  digitalWrite(PinBridH1, LOW);\n  digitalWrite(PinBridH2, LOW);\n  digitalWrite(PinBridH3, LOW);\n  digitalWrite(PinBridH4, LOW);\n  setMotorStatus(\"stopped\");\n}\n\nvoid turnLeft(){\n  digitalWrite(PinBridH1, HIGH);\n  digitalWrite(PinBridH2, LOW);\n  digitalWrite(PinBridH3, LOW);\n  digitalWrite(PinBridH4, HIGH);\n  setMotorStatus(\"turningLeft\");\n}\n\n\nvoid turnRight(){\n  digitalWrite(PinBridH1, LOW);\n  digitalWrite(PinBridH2, HIGH);\n  digitalWrite(PinBridH3, HIGH);\n  digitalWrite(PinBridH4, LOW);\n  setMotorStatus(\"turningRight\");\n}\n\n\nString getStatus(){\n  int d = hc.measureDistanceCm();\n  if(d==0){\n    d=1024;\n  }\n\n  \nString out =  \n\"ledStatus(\"+strLedStatus+\");\"+\n\"lightStatus(\"+strLightStatus+\");\"+\n\"breakLStatus(\"+strBreakLStatus+\");\"+\n\"buzzerStatus(\"+strBuzzerStatus+\");\"+\n\"luminosity(\"+String(analogRead(PinLDR))+\");\"+\n\"distance(\"+String(d)+\");\"+\n\"motorStatus(\"+strMotorStatus+\");\";\n   \nreturn out;\n}\n\nvoid setBuzzerStatus(String newValue){\n  strBuzzerStatus=newValue;\n}\n\nvoid setLedStatus(String newValue){\n  strLedStatus=newValue;\n}\n\nvoid setLightStatus(String newValue){\n  strLightStatus=newValue;\n}\n\nvoid setBreakLStatus(String newValue){\n  strBreakLStatus=newValue;\n}\n\nvoid setMotorStatus(String newValue){\n  strMotorStatus=newValue;\n}\n\n\n\nvoid setup(){\n  pinMode(PinLight,   OUTPUT);\n  pinMode(PinBreakL,  OUTPUT);\n  pinMode(PinBuzzer,  OUTPUT);\n  pinMode(PinLed,     OUTPUT);\n  pinMode(PinBridH1,  OUTPUT);\n  pinMode(PinBridH2,  OUTPUT);\n  pinMode(PinBridH3,  OUTPUT);\n  pinMode(PinBridH4,  OUTPUT);\n  pinMode(PinLDR,     INPUT);\n  pinMode(PinTrig,    OUTPUT);\n  pinMode(PinEcho,    INPUT);\n  Serial.begin(9600);\n\n  setLedStatus(\"off\");\n    setLightStatus(\"off\");\n    setBreakLStatus(\"off\");\n    setBuzzerStatus(\"off\");\n    setMotorStatus(\"stopped\");\n\n}\n\nvoid powerOff() {\n  for (int i = 2; i <= 13; i++) {\n    digitalWrite(i, LOW);\n  }\n  \n#ifdef ARDUINO_AVR_MEGA\n  for (int i = 22; i <= 53; i++) {\n    digitalWrite(i, LOW);\n  }\n#endif\n}"}]}